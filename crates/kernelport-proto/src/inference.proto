syntax = "proto3";
package kernelport.v1;

message Tensor {
  // Minimal v0 tensor format (CPU bytes only)
  string name = 1;
  string dtype = 2;          // "F32", "I64", etc.
  repeated int64 shape = 3;
  bytes data = 4;
}

message PredictRequest {
  string model = 1;
  repeated Tensor inputs = 2;
}

message PredictResponse {
  repeated Tensor outputs = 1;
  uint64 queued_us = 2;
  uint64 batched_us = 3;
  uint64 backend_us = 4;
}

service InferenceService {
  rpc Predict(PredictRequest) returns (PredictResponse);
}

